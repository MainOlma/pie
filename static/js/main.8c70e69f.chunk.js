(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,function(e,t,l){e.exports=l.p+"static/media/pie.adbe3ee1.png"},,,function(e,t,l){e.exports=l(14)},,,,,,function(e,t,l){},function(e,t,l){},function(e,t,l){"use strict";l.r(t);var n=l(0),a=l.n(n),r=l(5),c=l.n(r),i=(l(12),l(2)),s=l(1),o=(l(13),l(3)),d=l.n(o);var u=function(e){var t=a.a.createRef(),l=Object(n.useState)(0),r=Object(i.a)(l,2),c=r[0],o=r[1];Object(n.useEffect)(function(){console.log(e.data.length,e.fills.length,c,"hook"),0!=e.data.length&&0!=e.fills.length&&0==c&&d()});var d=function(){var l=s.d(t.current);console.log(l,t);var n=e.data,a=e.fills,r=s.c().key(function(e){return e}).rollup(function(e){return e.length}).entries(a).sort(function(e,t){return s.b(e.value,t.value)}),c=r.slice(0,7).map(function(e){return e.key});r.slice(8).map(function(e){return e.key}),n.forEach(function(e){e.mod_fill_1=c.includes(e.fill_1)?e.fill_1:"Other",e.mod_fill_2=c.includes(e.fill_2)?e.fill_2:"Other"}),(c=c.filter(function(e){return"None"!=e})).push("Other");var i=[],d=l.append("g").attr("class","lines"),u=l.append("g").attr("class","texts");c.forEach(function(e,t){var a=0;l.append("text").attr("x",20*a).attr("y",40*t+25).text(e).classed(e,!0);for(var r=function(){var l=c[s];a++;var r=n.filter(function(t){return t.mod_fill_1==e&&t.mod_fill_2==l||t.mod_fill_1==e&&"None"==t.mod_fill_2&&e==l}),o=n.filter(function(t){return t.mod_fill_2==e&&t.mod_fill_1==l&&e!=l});u.append("circle").attr("r",function(e){return r.length+o.length>0?8:0}).attr("cx",20*a+100+5).attr("cy",20*t+20*s+25-5).classed(e,!0).classed(l,!0),u.append("text").attr("x",20*a+100+5).attr("y",20*t+20*s+25).text(function(){return r.length+o.length>0?r.length+o.length:""}).classed("row_"+e,!0).classed("col_"+l,!0),i.push({fill_1:e,fill_2:l,count:r.length+o.length})},s=t;s<=c.length-1;s++)r();d.append("line").attr("x1",125).attr("y1",40*t+20).attr("x2",20*a+125-15-5).attr("y2",20*t+20*s-5+5).attr("stroke","green").attr("class",e),d.append("line").attr("x1",125).attr("y1",40*t+20).attr("x2",20*t+125).attr("y2",40*t+20-20*(7-a)).attr("stroke","blue").attr("class",e)}),c.forEach(function(t,n){console.log(t),l.selectAll("text."+t).on("mouseover",function(){var t=s.d(this).attr("class");e.selectedFill(t),l.selectAll("text").classed("hovered",!1),s.d(this).classed("hovered",!0),l.selectAll("text.col_"+t).classed("hovered",!0),l.selectAll("text.row_"+t).classed("hovered",!0),d.selectAll("line").classed("hovered",!1),d.selectAll("line."+t).classed("hovered",!0),u.selectAll("circle").classed("hovered",!1),u.selectAll("circle."+t).classed("hovered",!0)}).on("mouseout",function(){e.selectedFill("none"),l.selectAll("text").classed("hovered",!1),d.selectAll("line").classed("hovered",!1),u.selectAll("circle").classed("hovered",!1)})}),o(1)};return a.a.createElement("div",{className:"triangle"},a.a.createElement("h3",null,"Filling filter"),a.a.createElement("svg",{ref:t,width:260,height:300}))};var f=function(){var e=a.a.createRef(),t=Object(n.useState)([]),l=Object(i.a)(t,2),r=l[0],c=l[1],o=Object(n.useState)([]),f=Object(i.a)(o,2),m=f[0],p=f[1],h=Object(n.useState)("none"),v=Object(i.a)(h,2),_=v[0],g=v[1];Object(n.useEffect)(function(){s.a("https://docs.google.com/spreadsheets/d/e/2PACX-1vTT_w_1rgvRuiIkhgZ7GGjhWdxNTY2zuFEsuT7AtK80ryUlPZMN96ROjIljXTAewLEm6CClM5HwIiFv/pub?gid=0&single=true&output=csv").then(function(e){var t=[],l=s.g("%Y-%m-%d"),n=e.map(function(e,n){var a=""!=e["primary filling"]?e["primary filling"].replace(" ","_"):"None",r=""!=e["secondary filling"]?e["secondary filling"].replace(" ","_"):"None";return t.push(a),t.push(r),{id:n,name:e.Pie,date:l(e["Date served"]),alec:e["alec will eat it"],crust:e["one-crust"]&&!e["two crust"]?1:2,img:e[Image],fill_1:a,fill_2:r}}),a=s.c().key(function(e){return e}).rollup(function(e){return e.length}).entries(t).sort(function(e,t){return s.b(e.value,t.value)}).slice(0,7).map(function(e){return e.key});n.forEach(function(e){e.mod_fill_1=a.includes(e.fill_1)?e.fill_1:"Other",e.mod_fill_2=a.includes(e.fill_2)?e.fill_2:"Other"}),c(n),p(t)})},[]),Object(n.useEffect)(function(){y(r)}),Object(n.useEffect)(function(){"none"===_?s.e("span.pie").classed("activeItem",!0).classed("unactiveItem",!1):(s.e("span.pie").classed("unactiveItem",!0),s.e("span.pie."+_).classed("unactiveItem",!1))});var y=function(t){var l=s.d(e.current),n=s.f("%Y %B"),a=s.c().key(function(e){return n(e.date)}).entries(t),r=l.selectAll("div.pies_in_month").data(a).enter().append("div").classed("pies_in_month",!0);if(r.append("div").classed("month_name",!0).html(function(e){var t=s.f("%B"),l=s.f("%Y"),n=s.g("%Y %B"),a=t(n(e.key));return"<span class='year"+l(n(e.key))+"'>"+l(n(e.key))+"</span>"+a}),l.selectAll(".year2018").filter(function(e,t){return 0==t}).classed("visible",!0),l.selectAll(".year2019").filter(function(e,t){return 0==t}).classed("visible",!0),l.selectAll(".year2020").filter(function(e,t){return 0==t}).classed("visible",!0),l.select(".year2019").node()){var c=l.select(".year2019").node().parentNode.parentNode,i=l.select(".year2019").node().parentNode.parentNode.parentNode;console.log(c);var o=document.createElement("div");o.className="line_breaker",i.insertBefore(o,c)}r.append("div").classed("pies_list",!0).selectAll("div.pie").data(function(e){return e.values}).enter().append("span").classed("pie",!0).html(function(e){return console.log(d.a),"<img alt='"+e.name+"' src='"+d.a+"' width='50'>"}).attr("class",function(e,t,l){return"pie "+e.fill_1+" "+e.fill_2+" "+e.mod_fill_1+" "+e.mod_fill_2+" "+b(e.fill_1,e.fill_2)+E(e,l[t+1])}).on("mouseover",function(e){s.d("body").append("div").classed("tooltip",!0).html("<img  alt='"+e.name+"' src='"+d.a+"' width='256' height='256'> <div class='details'>crust: "+e.crust+"<br>alec: "+e.alec+"<br>fill 1: "+e.fill_1+"<br>fill 2: "+e.fill_2+"<br></div>").style("left",s.d(this).node().getBoundingClientRect().left-88+"px").style("top",s.d(this).node().getBoundingClientRect().top+50+"px")}).on("mouseout",function(e){s.d(".tooltip").remove()})},b=function(e,t){return e===_||t===_?"activeItem":"unactiveItem"},E=function(e,t){if(t&&e.date.getTime()===t.__data__.date.getTime())return" wrapPie "};return a.a.createElement("div",null,a.a.createElement("div",{className:"left_side"},a.a.createElement("div",{className:"sticky_top"},a.a.createElement("h1",null,"The Pie Chart"),a.a.createElement("h2",null,"The pies proudly eaten by the Stamen team"),a.a.createElement(u,{data:r,fills:m,selectedFill:function(e){g(e)}})),a.a.createElement("div",{className:"unsticky"}),a.a.createElement("div",{className:"sticky_bottom"},a.a.createElement("div",{className:"footer"},"Made by ",a.a.createElement("a",{href:"https://kmpny.github.io"},"Kompany"),", ",a.a.createElement("a",{href:"https://docs.google.com/spreadsheets/d/1npXQKNySYcRpiwp3-Iug3ncmCUS9F813LoxZQzSbVLU/edit#gid=0"},"data")," collected by ",a.a.createElement("a",{href:"https://stamen.com"},"Stamen")))),a.a.createElement("div",{className:"right_side"},a.a.createElement("div",{className:"pies",ref:e})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(f,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[6,1,2]]]);
//# sourceMappingURL=main.8c70e69f.chunk.js.map